
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Buffer Overflow Prep Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="brainstorm.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Offensive Path - TryHackMe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting-started/tutorial.html">
            
                <a href="../getting-started/tutorial.html">
            
                    
                    Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting-started/vulnversity.html">
            
                <a href="../getting-started/vulnversity.html">
            
                    
                    Vulnversity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../getting-started/blue.html">
            
                <a href="../getting-started/blue.html">
            
                    
                    Blue
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../getting-started/kenobi.html">
            
                <a href="../getting-started/kenobi.html">
            
                    
                    Kenobi
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../advanced-exploitation/">
            
                <a href="../advanced-exploitation/">
            
                    
                    Advanced Exploitation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../advanced-exploitation/steel-mountain.html">
            
                <a href="../advanced-exploitation/steel-mountain.html">
            
                    
                    Steel Mountain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../advanced-exploitation/alfred.html">
            
                <a href="../advanced-exploitation/alfred.html">
            
                    
                    Alfred
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../advanced-exploitation/hackpark.html">
            
                <a href="../advanced-exploitation/hackpark.html">
            
                    
                    HackPark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../advanced-exploitation/game-zone.html">
            
                <a href="../advanced-exploitation/game-zone.html">
            
                    
                    Game Zone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../advanced-exploitation/skynet.html">
            
                <a href="../advanced-exploitation/skynet.html">
            
                    
                    Skynet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../advanced-exploitation/daily-bugle.html">
            
                <a href="../advanced-exploitation/daily-bugle.html">
            
                    
                    Daily Bugle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../advanced-exploitation/overpass-2-hacked.html">
            
                <a href="../advanced-exploitation/overpass-2-hacked.html">
            
                    
                    Overpass 2 - Hacked
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../advanced-exploitation/relevant.html">
            
                <a href="../advanced-exploitation/relevant.html">
            
                    
                    Relevant
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../advanced-exploitation/internal.html">
            
                <a href="../advanced-exploitation/internal.html">
            
                    
                    Internal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../active-directory/">
            
                <a href="../active-directory/">
            
                    
                    Active Directory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../active-directory/active-directory-basics.html">
            
                <a href="../active-directory/active-directory-basics.html">
            
                    
                    Active Directory Basics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Binary Overflow Exploitation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="buffer-overflow-prep.html">
            
                <a href="buffer-overflow-prep.html">
            
                    
                    Buffer Overflow Prep
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="brainstorm.html">
            
                <a href="brainstorm.html">
            
                    
                    Brainstorm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="gatekeeper.html">
            
                <a href="gatekeeper.html">
            
                    
                    Gatekeeper
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Buffer Overflow Prep</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="buffer-overflow-prep">Buffer Overflow Prep</h1>
<h3 id="tasks">Tasks:</h3>
<ol>
<li><strong>Deploy VM</strong>:<ol>
<li>Run <code>xfreerdp /u:admin /p:password /cert:ignore /v:10.10.41.141 /workarea</code> to RDP into machine</li>
<li>Transfer all binaries in vulnerable-apps to your local windows vm for easier exploits.</li>
</ol>
</li>
<li><strong>oscp.exe - OVERFLOW1</strong>:<ol>
<li>Open oscp.exe in Immunity Debugger and run. It should start listening on port 1337. <code>ncat 127.0.0.1 1337</code> in your local windows VM. Now type <code>HELP</code> , There are 10 different overflow commands such as <code>OVERFLOW1 [value]</code> .</li>
<li>Run <a href="https://gist.github.com/jayateertha043/fbe860de237a715b9e8987a8b68a9a21" target="_blank">fuzzer.py</a> and note no. of bytes required to crash the application - 2000</li>
<li>Run <a href="https://gist.github.com/jayateertha043/530a41fc33c092a6de85538db7ba895a" target="_blank">exploit.py</a> by replacing the payload with cyclic string generated using <a href="https://wiremask.eu/tools/buffer-overflow-pattern-generator/" target="_blank">online tool</a> or using metasploit framework pattern_<em>create.rb. Run </em><code>!mona findmsp -distance 2000</code> to find offset when buffer overflows and submit answer- 1978</li>
<li>Again replace payload with badchars from <a href="https://gist.github.com/jayateertha043/51a8e5ff9984e85f80fcfdb36572bea9" target="_blank">bad_char.py</a> and run exploit.py</li>
<li> Look for missing bad characters if any by following ESP stack dump. If any of them is missing or not in order, try removing them from payload and repeat till all the bad characters are in same order as sent. <code>Bad chars - \x00\x07\x2e\xa0</code></li>
<li>You can also do <code>!mona bytearray -b &quot;\x00&quot;</code> and then send badchars &amp; run <code>!mona compare -f &quot;bytearray.bin&quot; -a 0124FA18</code> where -a takes ESP location as argument. This will produce <code>\x07\x08\x2e\x2f\xa0\xa1</code> as bad chars , not all of them are bad , try removing only <code>\x07\x2e\xa0</code> and send payload &amp; repeat step 6, Notice there are no more bad chars. <code>Bad chars - \x00\x07\x2e\xa0</code>. Submit the bad chars obtained to complete this task.</li>
</ol>
</li>
<li><strong>oscp.exe - OVERFLOW2</strong>:</li>
<li><strong>oscp.exe - OVERFLOW3</strong>:</li>
<li><strong>oscp.exe - OVERFLOW4</strong>:</li>
<li><strong>oscp.exe - OVERFLOW5</strong>:</li>
<li><strong>oscp.exe - OVERFLOW6</strong>:</li>
<li><strong>oscp.exe - OVERFLOW7</strong>:</li>
<li><strong>oscp.exe - OVERFLOW8</strong>:</li>
<li><strong>oscp.exe - OVERFLOW9</strong>:</li>
<li><strong>oscp.exe - OVERFLOW10</strong>:<ol>
<li>same as task 2 just replace OVERFLOW1 with OVERFLOW{n} in  <a href="https://gist.github.com/jayateertha043/fbe860de237a715b9e8987a8b68a9a21" target="_blank">fuzzer.py</a> and  <a href="https://gist.github.com/jayateertha043/530a41fc33c092a6de85538db7ba895a" target="_blank">exploit.py</a>. </li>
</ol>
</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Binary Overflow Exploitation">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="brainstorm.html" class="navigation navigation-next " aria-label="Next page: Brainstorm">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Buffer Overflow Prep","level":"1.5.1","depth":2,"next":{"title":"Brainstorm","level":"1.5.2","depth":2,"path":"binary-overflow-exploitation/brainstorm.md","ref":"binary-overflow-exploitation/brainstorm.md","articles":[]},"previous":{"title":"Binary Overflow Exploitation","level":"1.5","depth":1,"path":"binary-overflow-exploitation/README.md","ref":"binary-overflow-exploitation/README.md","articles":[{"title":"Buffer Overflow Prep","level":"1.5.1","depth":2,"path":"binary-overflow-exploitation/buffer-overflow-prep.md","ref":"binary-overflow-exploitation/buffer-overflow-prep.md","articles":[]},{"title":"Brainstorm","level":"1.5.2","depth":2,"path":"binary-overflow-exploitation/brainstorm.md","ref":"binary-overflow-exploitation/brainstorm.md","articles":[]},{"title":"Gatekeeper","level":"1.5.3","depth":2,"path":"binary-overflow-exploitation/gatekeeper.md","ref":"binary-overflow-exploitation/gatekeeper.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"binary-overflow-exploitation/buffer-overflow-prep.md","mtime":"2021-11-27T14:43:59.610Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-11-27T14:44:24.389Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

